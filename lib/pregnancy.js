// Pregnancy information by week
// Covers weeks 4-12 (early pregnancy, most relevant for Feb 2026 based on late Dec/early Jan conception)

export const pregnancyWeeks = {
  4: {
    baby: "The embryo is implanting into the uterine wall. It's about the size of a poppy seed.",
    mom: "She might not know she's pregnant yet. Some women experience light spotting (implantation bleeding) or mild cramping. Fatigue may begin.",
    support: [
      "Be attentive to her energy levels without being overbearing",
      "Make sure there's plenty of water around the house",
      "Start taking on more household tasks quietly",
      "Be patient if she seems tired or emotional"
    ]
  },
  5: {
    baby: "The heart is beginning to form and will start beating this week. Baby is the size of a sesame seed.",
    mom: "Morning sickness may begin. Breast tenderness, fatigue, and frequent urination are common. Emotions may feel intense.",
    support: [
      "Keep crackers by the bedside for morning nausea",
      "Don't wear strong cologne or cook pungent foods",
      "Offer ginger tea or ginger candies",
      "Be emotionally present‚Äîjust listen without trying to fix"
    ]
  },
  6: {
    baby: "The neural tube is closing. Tiny buds for arms and legs appear. Baby is the size of a lentil.",
    mom: "Nausea often peaks. She may have food aversions, heightened sense of smell, and extreme fatigue. Mood swings are common.",
    support: [
      "Ask what foods sound tolerable before cooking",
      "Take over meal planning if she can't think about food",
      "Let her rest without guilt‚Äîgrowing a human is exhausting",
      "Validate her feelings without minimizing them"
    ]
  },
  7: {
    baby: "Brain development is rapid. Hands and feet are forming. Baby is the size of a blueberry.",
    mom: "Nausea continues. She may experience bloating, constipation, and vivid dreams. First prenatal appointment often happens this week.",
    support: [
      "Offer to go to every appointment‚Äîyour presence matters",
      "Stock up on high-fiber foods and prunes",
      "Create a calm bedtime routine together",
      "Start a shared journal or notes app for questions for the doctor"
    ]
  },
  8: {
    baby: "All major organs are beginning to develop. Baby is moving, though she can't feel it yet. Size of a kidney bean.",
    mom: "Nausea may be at its worst. Fatigue is intense. She might feel like she's on an emotional rollercoaster.",
    support: [
      "This is often the hardest week‚Äîbe extra patient and loving",
      "Don't take mood swings personally",
      "Small gestures matter: bring her a cold cloth, rub her back",
      "Remind her this phase is temporary"
    ]
  },
  9: {
    baby: "Baby is starting to look more human. Tiny muscles are forming. Size of a grape.",
    mom: "Nausea may start to ease for some. Waistline may be thickening. She might feel anxious about the pregnancy.",
    support: [
      "Reassure her that anxiety is normal",
      "Start researching together‚Äîbirth classes, hospitals, etc.",
      "Celebrate small wins: 'We made it through another week'",
      "Plan a low-key date that doesn't involve food smells"
    ]
  },
  10: {
    baby: "Vital organs are fully formed and beginning to function. Baby is the size of a kumquat.",
    mom: "Energy might slightly improve. Visible veins may appear on breasts and belly. Round ligament pain may start.",
    support: [
      "Encourage gentle movement‚Äîwalks together are great",
      "Help her stay hydrated (dehydration worsens everything)",
      "Be flexible with plans‚Äîshe may need to cancel last minute",
      "Start talking about your hopes and dreams for your family"
    ]
  },
  11: {
    baby: "Baby is now officially a fetus. Tooth buds and nail beds are forming. Size of a fig.",
    mom: "Nausea often improves. She may feel bloated and have skin changes (acne or 'glow'). Headaches are common.",
    support: [
      "Keep pain relievers she can safely take on hand (check with doctor)",
      "Offer head and neck massages",
      "Compliment her genuinely‚Äîshe may not feel attractive",
      "Take photos if she's comfortable‚Äîyou'll treasure these"
    ]
  },
  12: {
    baby: "Reflexes are developing‚Äîbaby can open and close fingers. Size of a lime. Risk of miscarriage drops significantly.",
    mom: "Many women start feeling better! Energy often returns. She may start 'showing' slightly. This is often when couples share the news.",
    support: [
      "Celebrate reaching this milestone together",
      "Discuss when/how to share the news with family and friends",
      "Start thinking about nursery ideas if she's ready",
      "Plan something special‚Äîyou've both made it through the hardest part"
    ]
  },
  13: {
    baby: "Vocal cords are forming. Fingerprints are developing. Size of a peapod.",
    mom: "Welcome to the second trimester! Energy typically improves. Libido may return. The 'pregnancy glow' often appears.",
    support: [
      "Reconnect intimately if she's interested‚Äîfollow her lead",
      "Plan a babymoon if schedules allow",
      "Start reading about childbirth together",
      "Express gratitude for everything she's going through"
    ]
  },
  14: {
    baby: "Baby can make facial expressions. Body is growing faster than the head now. Size of a lemon.",
    mom: "Appetite often increases. She may feel more like herself. Some women experience nasal congestion ('pregnancy rhinitis').",
    support: [
      "Cook nutritious meals she's craving",
      "Get a humidifier for the bedroom if she's congested",
      "Enjoy this more stable phase together",
      "Keep up the habits you've built‚Äîshe needs a healthy partner too"
    ]
  },
  15: {
    baby: "Baby can sense light through closed eyelids. Legs are now longer than arms. Size of an apple.",
    mom: "The 'golden period' of pregnancy begins. Energy is up, nausea usually gone. She may start feeling flutters (quickening).",
    support: [
      "Ask about baby names if she's ready to discuss",
      "Start planning the nursery together",
      "Take a prenatal class or tour the hospital",
      "Keep exercising together‚Äîwalks, swimming, or yoga"
    ]
  },
  16: {
    baby: "Baby can hear sounds! Facial muscles are working, and baby may start sucking their thumb. Size of an avocado.",
    mom: "She may feel the baby move for the first time. Appetite is often strong. Back pain and round ligament pain may increase.",
    support: [
      "Put your hand on her belly when she feels movement",
      "Offer back rubs and foot massages regularly",
      "Help with groceries and healthy meal prep",
      "Read or sing to the baby‚Äîthey can hear you now"
    ]
  },
  17: {
    baby: "Baby is developing fat stores and sweat glands. Skeleton is hardening from cartilage to bone. Size of a pear.",
    mom: "Growing belly is more noticeable. She may experience vivid dreams, increased appetite, and occasional dizziness.",
    support: [
      "Help her find comfortable sleeping positions (left side is best)",
      "Stock up on healthy, satisfying snacks",
      "Start discussing birth preferences together",
      "Be her advocate at medical appointments"
    ]
  },
  18: {
    baby: "Baby is yawning, hiccupping, and swallowing. If it's a girl, her uterus and fallopian tubes are formed. Size of a sweet potato.",
    mom: "Anatomy scan is typically scheduled (18-22 weeks). She may feel stronger movements. Possible swelling in feet and ankles.",
    support: [
      "Attend the anatomy scan together‚Äîthis is a big one",
      "Help her elevate her feet when they're swollen",
      "Start thinking about a birth plan together",
      "Capture this milestone‚Äîjournal or photos"
    ]
  },
  19: {
    baby: "A protective coating called vernix caseosa covers the skin. Baby's senses are developing rapidly. Size of a mango.",
    mom: "She may experience hip pain, leg cramps, and skin changes. The halfway point is approaching!",
    support: [
      "Celebrate the upcoming halfway milestone together",
      "Help with stretching exercises for hip and leg relief",
      "Research pediatricians and childcare options",
      "Keep communicating openly about both your feelings"
    ]
  },
  20: {
    baby: "Halfway there! Baby can hear your voice clearly now. Taste buds are developing. Size of a banana.",
    mom: "The uterus is at belly button level. She may feel Braxton Hicks contractions. Energy is generally good.",
    support: [
      "Celebrate this huge milestone‚Äîyou're halfway!",
      "Talk to the baby regularly‚Äîyour voice is becoming familiar",
      "Start planning a babymoon if schedules allow",
      "Review finances and parental leave options"
    ]
  },
  21: {
    baby: "Baby's movements are more coordinated. Eyebrows and eyelids are fully formed. Size of a carrot.",
    mom: "Stretch marks may appear. She may feel the baby's sleep/wake cycle. Braxton Hicks may become more noticeable.",
    support: [
      "Offer to apply moisturizer on her belly for comfort",
      "Notice the baby's active times and share in the excitement",
      "Start assembling baby gear and the nursery",
      "Plan together for the third trimester ahead"
    ]
  },
  22: {
    baby: "Baby looks like a miniature newborn. Lips and eyelids are more distinct. Grip is getting stronger. Size of a papaya.",
    mom: "She may experience backaches, swollen ankles, and trouble sleeping. Appetite continues to increase.",
    support: [
      "Help create a comfortable sleep environment",
      "Take over more household responsibilities",
      "Attend childbirth education classes together",
      "Remind her (and yourself) how strong you both are"
    ]
  }
};

export const pregnancyMilestones = [
  { week: 6, label: "First heartbeat detectable", emoji: "üíì" },
  { week: 8, label: "First prenatal visit window", emoji: "üè•" },
  { week: 10, label: "NIPT / genetic screening window", emoji: "üß¨" },
  { week: 12, label: "End of first trimester", emoji: "üéâ" },
  { week: 13, label: "Second trimester begins", emoji: "‚ú®" },
  { week: 16, label: "Baby can hear sounds", emoji: "üëÇ" },
  { week: 18, label: "Anatomy scan window (18-22w)", emoji: "üì∑" },
  { week: 20, label: "Halfway point!", emoji: "üéØ" },
];

export function calculatePregnancyWeek(lmpDate, cycleLength = 28) {
  const today = new Date();
  const lmp = new Date(lmpDate);
  
  // Adjust for cycle length (standard calculation assumes 28-day cycle)
  const ovulationDay = cycleLength - 14;
  const adjustment = ovulationDay - 14; // Days to add/subtract from standard
  
  const daysSinceLMP = Math.floor((today - lmp) / (1000 * 60 * 60 * 24));
  const adjustedDays = daysSinceLMP - adjustment;
  
  const weeks = Math.floor(adjustedDays / 7);
  const days = adjustedDays % 7;
  
  return { weeks, days, totalDays: adjustedDays };
}

export function getPregnancyInfo(lmpDate, cycleLength = 28) {
  const { weeks, days } = calculatePregnancyWeek(lmpDate, cycleLength);
  
  // Get info for current week, default to week 4 or 14 if out of range
  let weekInfo;
  if (weeks < 4) {
    weekInfo = {
      baby: "It's very early! The fertilized egg is making its way to the uterus.",
      mom: "She likely doesn't know she's pregnant yet. No symptoms typically.",
      support: [
        "Continue being a supportive partner",
        "Focus on your own health and preparation",
        "Stay positive and present"
      ]
    };
  } else if (weeks > 14) {
    weekInfo = pregnancyWeeks[14];
  } else {
    weekInfo = pregnancyWeeks[weeks];
  }
  
  return {
    weeks,
    days,
    weekLabel: `${weeks} weeks, ${days} days`,
    trimester: weeks < 13 ? 1 : weeks < 27 ? 2 : 3,
    ...weekInfo
  };
}

export function getPregnancyPercentage(lmpDate, cycleLength = 28) {
  const { weeks, days } = calculatePregnancyWeek(lmpDate, cycleLength);
  const totalDays = weeks * 7 + days;
  const fullTermDays = 40 * 7; // 280 days = 40 weeks
  return {
    percent: Math.min(Math.round((totalDays / fullTermDays) * 100), 100),
    weeks,
    days,
    totalDays,
    fullTermDays
  };
}

export function getEstimatedDueDate(lmpDate, cycleLength = 28) {
  const lmp = new Date(lmpDate + 'T12:00:00');
  const ovulationDay = cycleLength - 14;
  const adjustment = ovulationDay - 14;
  const dueDate = new Date(lmp);
  dueDate.setDate(dueDate.getDate() + 280 + adjustment);
  return dueDate;
}

export function getPregnancyInfoAtDate(lmpDate, targetDate, cycleLength = 28) {
  const lmp = new Date(lmpDate);
  const target = new Date(targetDate);
  const ovulationDay = cycleLength - 14;
  const adjustment = ovulationDay - 14;
  const daysSinceLMP = Math.floor((target - lmp) / (1000 * 60 * 60 * 24));
  const adjustedDays = daysSinceLMP - adjustment;
  const weeks = Math.floor(adjustedDays / 7);
  const days = adjustedDays % 7;

  let weekInfo;
  if (weeks < 4) {
    weekInfo = {
      baby: "It's very early! The fertilized egg is making its way to the uterus.",
      mom: "She likely doesn't know she's pregnant yet. No symptoms typically.",
      support: ["Continue being a supportive partner", "Focus on your own health", "Stay positive and present"]
    };
  } else if (weeks > 22) {
    weekInfo = pregnancyWeeks[22];
  } else {
    weekInfo = pregnancyWeeks[weeks] || pregnancyWeeks[14];
  }

  const trimester = weeks < 13 ? 1 : weeks < 27 ? 2 : 3;
  const upcomingMilestones = pregnancyMilestones.filter(m => m.week >= weeks && m.week <= weeks + 4);

  return { weeks, days, trimester, ...weekInfo, upcomingMilestones };
}

export function getDailyTip(lmpDate, cycleLength = 28) {
  const info = getPregnancyInfo(lmpDate, cycleLength);
  const dayOfWeek = new Date().getDay();
  
  // Rotate through support tips based on day
  const tipIndex = dayOfWeek % info.support.length;
  
  return {
    ...info,
    todaysTip: info.support[tipIndex]
  };
}
